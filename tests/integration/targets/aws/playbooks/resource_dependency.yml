- hosts: localhost
  gather_facts: false
  collections:
  - cloud.pravic
  environment:
    AWS_ACCESS_KEY_ID: "{{ aws_access_key }}"
    AWS_SECRET_ACCESS_KEY: "{{ aws_secret_key }}"
    AWS_SESSION_TOKEN: "{{ security_token | default(omit) }}"
    AWS_DEFAULT_REGION: "{{ aws_region | default('us-east-1') }}"

  tasks:
  - ansible.builtin.include_vars: ../files/resources.yml

  - block:
    - cloud.pravic.resources:
        state: "{{ state | default('present') }}"
    always:
      - cloud.pravic.resources:
          state: "{{ state | default('absent') }}"
